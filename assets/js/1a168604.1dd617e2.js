"use strict";(self.webpackChunkrest_api_docs=self.webpackChunkrest_api_docs||[]).push([[4782],{18851:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var n=a(74848),s=a(28453);const r={title:"Execute a datamart",description:"This workflow sample demonstrates how to execute a datamart using REST APIs."},o=void 0,i={id:"common-workflows/modeling/manage-datamart-objects/execute-a-datamart",title:"Execute a datamart",description:"This workflow sample demonstrates how to execute a datamart using REST APIs.",source:"@site/docs/common-workflows/modeling/manage-datamart-objects/execute-a-datamart.md",sourceDirName:"common-workflows/modeling/manage-datamart-objects",slug:"/common-workflows/modeling/manage-datamart-objects/execute-a-datamart",permalink:"/rest-api-docs/common-workflows/modeling/manage-datamart-objects/execute-a-datamart",draft:!1,unlisted:!1,editUrl:"https://github.com/MicroStrategy/rest-api-docs/tree/public/docs/common-workflows/modeling/manage-datamart-objects/execute-a-datamart.md",tags:[],version:"current",lastUpdatedBy:"wangrenhang",lastUpdatedAt:1711017072,formattedLastUpdatedAt:"Mar 21, 2024",frontMatter:{title:"Execute a datamart",description:"This workflow sample demonstrates how to execute a datamart using REST APIs."},sidebar:"tutorialSidebar",previous:{title:"Retrieve applicable properties of a datamart",permalink:"/rest-api-docs/common-workflows/modeling/manage-datamart-objects/retrieve-applicable-properties-of-a-datamart"},next:{title:"Manage derived element objects",permalink:"/rest-api-docs/common-workflows/modeling/manage-derived-element-objects/"}},c={},d=[{value:"Execute a datamart and insert the data to table",id:"execute-a-datamart-and-insert-the-data-to-table",level:2},{value:"Step 1: Create a datamart instance based on an existing datamart",id:"step-1-create-a-datamart-instance-based-on-an-existing-datamart",level:3},{value:"Step 2: Execute the datamart",id:"step-2-execute-the-datamart",level:3},{value:"Step 3: Answer the prompts (skip this step if the datamart has no prompts)",id:"step-3-answer-the-prompts-skip-this-step-if-the-datamart-has-no-prompts",level:3},{value:"Step 4: Change the prompt option and save(skip this step if keeping the default option)",id:"step-4-change-the-prompt-option-and-saveskip-this-step-if-keeping-the-default-option",level:3},{value:"Step 5: Delete the datamart instance",id:"step-5-delete-the-datamart-instance",level:3}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components},{Available:a}=t;return a||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Available",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a,{since:"2021 Update 9"}),"\n",(0,n.jsx)(t.p,{children:"This workflow sample demonstrates how to execute a datamart using REST APIs."}),"\n",(0,n.jsx)(t.p,{children:"The datamart object ID is 85000B907B4EAD3B0D9522A9CFD10DBC. The project ID is B7CA92F04B9FAE8D941C3E9B7E0CD754."}),"\n",(0,n.jsxs)(t.admonition,{type:"info",children:[(0,n.jsx)(t.p,{children:"An authorization token allows the API layer to hide internal session-related implementations such as managing different project-specific sessions. Once the REST API layer has validated the user's credentials using the specified authentication mode, it initiates a session with the Intelligence Server and creates a unique authorization token for the client."}),(0,n.jsxs)(t.p,{children:["Get the authorization token needed to execute the request with ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Authentication/postLogin",children:"POST /api/auth/login"}),"."]}),(0,n.jsxs)(t.p,{children:["Get the project ID from ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Projects/getProjects_1",children:"GET /api/projects"}),"."]})]}),"\n",(0,n.jsx)(t.h2,{id:"execute-a-datamart-and-insert-the-data-to-table",children:"Execute a datamart and insert the data to table"}),"\n",(0,n.jsx)(t.h3,{id:"step-1-create-a-datamart-instance-based-on-an-existing-datamart",children:"Step 1: Create a datamart instance based on an existing datamart"}),"\n",(0,n.jsxs)(t.p,{children:["User can create an instance using ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/ms-createDatamartInstance",children:"POST /api/model/datamarts/{datamartId}/instances"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'POST' \\\n  'https://demo.microstrategy.com/MicroStrategyLibrary/api/model/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances' \\\n  -H 'accept: */*' \\\n  -H 'X-MSTR-AuthToken: csgf8rns3orn8pnd1addkf01bk' \\\n  -H 'X-MSTR-ProjectID: B7CA92F04B9FAE8D941C3E9B7E0CD754'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Header:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-http",children:"cache-control: no-cache,no-store,max-age=0,must-revalidate,proxy-revalidate,no-transform\ncontent-encoding: gzip\ncontent-length: 22\ncontent-security-policy: frame-ancestors 'self'\ncontent-type: application/json\ndate: Thu,09 Feb 2023 06:16:42 GMT\nexpires: 0\npragma: no-cache\nserver: MicroStrategy\nstrict-transport-security: max-age=31536000;includeSubDomains\nx-content-type-options: nosniff\nx-mstr-ms-instance: 35DCAB983549ECD49FC20F9AB0CC4C28\nx-xss-protection: 1; mode=block\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 201 (The in-memory instance is created successfully.)"}),"\n",(0,n.jsx)(t.h3,{id:"step-2-execute-the-datamart",children:"Step 2: Execute the datamart"}),"\n",(0,n.jsxs)(t.p,{children:["User can execute the datamart using ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/execute",children:"POST /api/datamarts/{datamartId}/instances/{instanceID}/execution/jobs"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Execute a datamart may take a long time."}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'POST' \\\n'https://demo.microstrategy.com/MicroStrategyLibrary/api/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances/1C818981C44AC7447B9853B1B7F27200/execution/jobs' \\\n-H 'accept: application/json' \\\n-H 'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf' \\\n-H 'X-MSTR-ProjectID: B7CA92F04B9FAE8D941C3E9B7E0CD754'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "id": "85000B907B4EAD3B0D9522A9CFD10DBC",\n  "instanceId": "1C818981C44AC7447B9853B1B7F27200",\n  "status": 5,\n  "jobId": "10:RU5WLTMwODE3OUxBSU8yVVNFMQ=="\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 200 (OK)."}),"\n",(0,n.jsx)(t.h3,{id:"step-3-answer-the-prompts-skip-this-step-if-the-datamart-has-no-prompts",children:"Step 3: Answer the prompts (skip this step if the datamart has no prompts)"}),"\n",(0,n.jsxs)(t.p,{children:["User needs to check whether the datamart contains prompt using: ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/getExecution",children:"GET /api/datamarts/{datamartId}/instances/{instanceId}/execution"})]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'GET' \\\n'https://demo.microstrategy.com/MicroStrategyLibrary/api/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances/1C818981C44AC7447B9853B1B7F27200/execution' \\\n-H 'accept: application/json' \\\n-H 'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf' \\\n-H 'X-MSTR-ProjectID: B7CA92F04B9FAE8D941C3E9B7E0CD754'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "id": "85000B907B4EAD3B0D9522A9CFD10DBC",\n  "status": 2,\n  "instanceId": "1C818981C44AC7447B9853B1B7F27200"\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 200 (OK)."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"If status is not 2, the datamart has no prompts."}),"\n",(0,n.jsx)(t.li,{children:"If status is 2, the datamart has prompts."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["You can refer to ",(0,n.jsx)(t.a,{href:"https://microstrategy.github.io/rest-api-docs/common-workflows/analytics/use-prompts-objects/",children:"Use prompt objects"})," to get the information about the contained prompts."]}),"\n",(0,n.jsxs)(t.p,{children:["Then if the datamart contains prompts, user can answer prompt using ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Reports/answerPrompts_2",children:"PUT /api/reports/{reportId}/instances/{reportInstance}/prompts/answers"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "prompts": [\n    {\n      "name": "Elements of Country",\n      "type": "ELEMENTS",\n      "required": true,\n      "closed": false,\n      "source": {\n        "id": "8D679D3811D3E4981000E787EC6DE8A4",\n        "type": 12\n      },\n      "defaultAnswer": [],\n      "answers": [\n        {\n          "name": "USA"\n        },\n        {\n          "name": "England"\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'GET' \\\n'https://demo.microstrategy.com/MicroStrategyLibrary/api/reports/85000B907B4EAD3B0D9522A9CFD10DBC/instances/1C818981C44AC7447B9853B1B7F27200/prompts/answers' \\\n-H 'accept: application/json' \\\n-H 'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf' \\\n-H 'X-MSTR-ProjectID: B7CA92F04B9FAE8D941C3E9B7E0CD754'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 204 (Prompt has been answered.)"}),"\n",(0,n.jsx)(t.h3,{id:"step-4-change-the-prompt-option-and-saveskip-this-step-if-keeping-the-default-option",children:"Step 4: Change the prompt option and save(skip this step if keeping the default option)"}),"\n",(0,n.jsxs)(t.p,{children:["You can change the prompt option using: ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/ms-saveDatamartInstance",children:"POST /api/model/datamarts/{datamartId}/instances/save"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "promptOptions": {\n    "saveAsWithAnswers": true,\n    "saveAsFilterWithPrompts": true,\n    "saveAsTemplateWithPrompts": true\n  }\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'POST' \\\n'https://demo.microstrategy.com/MicroStrategyLibrary/api/model/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances/save' \\\n-H 'accept: application/json' \\\n-H 'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf' \\\n-H 'X-MSTR-MS-Instance: 1C818981C44AC7447B9853B1B7F27200' \\\n-H 'Content-Type: application/json' \\\n-d '{\n\"promptOptions\": {\n\"saveAsWithAnswers\": true,\n\"saveAsFilterWithPrompts\": true,\n\"saveAsTemplateWithPrompts\": true\n}\n}'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "objectId": "85000B907B4EAD3B0D9522A9CFD10DBC"\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 200 (The datamart definition is saved successfully.)"}),"\n",(0,n.jsxs)(t.p,{children:["If you want to change the datamart name or destination folder at the same time, you can use ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/ms-saveAsDatamartInstance",children:"POST /api/model/datamarts/{datamartId}/instances/saveAs"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-json",children:'{\n  "name": "City",\n  "destinationFolderId": "8A1831FF494F528D02A4A8BF5FB73459",\n  "promptOptions": {\n    "saveAsWithAnswers": true,\n    "saveAsFilterWithPrompts": true,\n    "saveAsTemplateWithPrompts": true\n  }\n}\n'})}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:'curl -X \'POST\' \\\n\'https://demo.microstrategy.com/MicroStrategyLibrary/api/model/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances/saveAs\' \\\n-H \'accept: application/json\' \\\n-H \'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf\' \\\n-H \'X-MSTR-MS-Instance: 1C818981C44AC7447B9853B1B7F27200\' \\\n-H \'Content-Type: application/json\' \\\n-d \'{\n"name": "City",\n"destinationFolderId": "8A1831FF494F528D02A4A8BF5FB73459",\n"promptOptions": {\n"saveAsWithAnswers": true,\n"saveAsFilterWithPrompts": true,\n"saveAsTemplateWithPrompts": true\n}\n}\'\n'})}),"\n",(0,n.jsxs)(t.p,{children:["Response is same with that of ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/ms-saveDatamartInstance",children:"POST /api/model/datamarts/{datamartId}/instances/save"}),"."]}),"\n",(0,n.jsx)(t.h3,{id:"step-5-delete-the-datamart-instance",children:"Step 5: Delete the datamart instance"}),"\n",(0,n.jsxs)(t.p,{children:["User can delete the created datamart instance using: ",(0,n.jsx)(t.a,{href:"https://demo.microstrategy.com/MicroStrategyLibrary/api-docs/index.html#/Datamarts/ms-deleteDatamartInstance",children:"DELETE /api/model/datamarts/{datamartId}/instances"}),"."]}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Body: Empty"}),"\n",(0,n.jsx)(t.p,{children:"Sample Request Curl:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"curl -X 'DELETE' \\\n'https://demo.microstrategy.com/MicroStrategyLibrary/api/model/datamarts/85000B907B4EAD3B0D9522A9CFD10DBC/instances' \\\n-H 'accept: application/json' \\\n-H 'X-MSTR-AuthToken: v5t198ft2mdjn571oabe7upibf' \\\n-H 'X-MSTR-MS-Instance: 1C818981C44AC7447B9853B1B7F27200' \\\n-H 'Content-Type: application/json'\n"})}),"\n",(0,n.jsx)(t.p,{children:"Sample Response Code: 204 (The in-memory instance is deleted successfully.)"})]})}function m(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},28453:(e,t,a)=>{a.d(t,{R:()=>o,x:()=>i});var n=a(96540);const s={},r=n.createContext(s);function o(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);